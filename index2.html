<!DOCTYPE html>
<html>
<head>
	<title>Page Title</title>

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="css/jquery.mobile-1.4.0.css" />
	<script src="js/jquery-1.9.1.js"></script>
	<script src="js/jquery.mobile-1.4.0.js"></script>
	<script type="text/javascript" charset="utf-8">
		var devices;
    $(document).on('pageinit', function() {
      // alert("pageinit");
      $.ajax({                    
          url: 'json.txt',
          dataType: 'json',
          cache: false,
          success: function( data, status ){
             // alert('radi');
             // alert(JSON.stringify(data));
              devices = data;
             // alert(status);
             // alert( data.responseData.results.length + ' results found!' );
            populateDevices(devices);
          },
          error: function(xhr, textStatus, err) { //odstampaj textStatus, err jbt
              alert('ne radi');
              alert(textStatus);
              alert(err);
              alert("readyState: "+xhr.readyState+"\n xhrStatus: "+xhr.status);
              alert("responseText: "+xhr.responseText);
          }
      }); //ajax

       $('#device_list_view').on('click', 'li', function() {
        alert("Works"); // id of clicked li by directly accessing DOMElement property
        });
      function populateDevices(){
              console.log("populateDevicess");
              $('#device_list_view').empty();
              device_array = devices.devices.device;  //devices is variable, devices is json hash, device is array
              
              $.each(device_array, function(index, value) {
                      var device = value;
                      var li = '<li class="ui-first-child"><a href="#">Test</a></li>';
              
                       $("#device_list_view").append(li);
                      // $('#device_list_view').append($('<li/>', {    //here appending `<li>`
                      // 'text': device['serial_number'] + " " + device['status']
                      // }));  


              });
              
              $('#device_list_view').listview('refresh');
      }//function

      $('#details').on('pageshow', function(event){
       //alert(devices.devices.device[0].serial_number);
       $('#serial_number').text(devices.devices.device[0].serial_number);
      });

    });
    </script>
</head>
<body>

<div data-role="page" id="main">

	<div data-role="header">
		<h1>Your Devices</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
	<ul id="device_list_view" data-filter="true" data-role="listview">
    <li>
      <a href="#">
        <div role="main" class="ui-content">
    <div class="ui-grid-a">
        <div class="ui-block-a">
          <div class="ui-bar ui-bar-a" style="height:60px"></div>
        </div>
        <div class="ui-block-b">
          <div class="ui-bar ui-bar-a" style="height:60px"></div>
        </div>
    </div><!-- /grid-a -->
    <div class="ui-grid-a">
        <div class="ui-block-a">
          <div class="ui-bar ui-bar-a" style="height:60px"></div>
        </div>
        <div class="ui-block-b">
          <div class="ui-bar ui-bar-a" style="height:60px"></div>
        </div>
    </div><!-- /grid-a -->
  </div><!-- /content -->
  </a>
    </li>


	</ul>
	</div><!-- /content -->

	<div data-role="footer">
		<h4>Network Fleet</h4>
	</div><!-- /footer -->
</div><!-- /page -->


<div data-role="page" id='details'>
	<div data-role="header">
		<h1>Device Details</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="ui-grid-a">
    		<div class="ui-block-a">
    			<div class="ui-bar ui-bar-a" style="height:60px">
            <p id="serial_number"></p>
          </div>
    		</div>
    		<div class="ui-block-b">
    			<div class="ui-bar ui-bar-a" style="height:60px">
            <p id="status"></p>
          </div>
    		</div>
		</div><!-- /grid-a -->
		<div class="ui-grid-a">
    		<div class="ui-block-a">
    			<div class="ui-bar ui-bar-a" style="height:60px">
            <p id="status"></p>
          </div>
    		</div>
    		<div class="ui-block-b">
    			<div class="ui-bar ui-bar-a" style="height:60px">
            <p id="conf_code"></p>
          </div>
    		</div>
		</div><!-- /grid-a -->
	</div><!-- /content -->

	<div data-role="footer">
		<h4>Network Fleet</h4>
	</div><!-- /footer -->
</div><!-- /page -->

</body>
</html>